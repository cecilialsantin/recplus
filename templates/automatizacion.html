{% extends "base.html" %}

{% block title %}Automatización en Loyal{% endblock %}

{% block content %}

<div class="welcome-bar">
    <h2>Automatización LOYAL</h2>
</div>
  
<!-- 🔹 Panel unificado para ID + botones + simulacro + log -->
<div class="form-box">
    <h3>Ingrese el ID de la Recepción</h3>
    <input type="text" id="id-recepcion" placeholder="Ejemplo: 123">
    <button onclick="cargarYMostrarRecepcion()"><i class="fa-solid fa-box-open"></i> Cargar Recepción</button>
    <p id="mensaje-carga"></p>

    <!-- 🔹 Botones simulación + confirmación -->
    <div class="acciones-lealtad" style="margin-top: 20px;">
        <button onclick="simularEnvioLoyal()" id="btn-simular" class="btn-procesar">
            <i class="fa-solid fa-robot"></i> Pre-Envio Loyal
        </button>
        <button onclick="confirmarEnvioLoyal()" id="btn-confirmar" class="btn-procesar" style="display:none">
            <i class="fa-solid fa-check"></i> Confirmar Envío
        </button>
    </div>

    <!-- 🔹 Resultado de simulacro -->
    <div id="resultado-envio" class="resultado-envio" style="margin-top: 20px;"></div>

    <!-- 🔹 Bitácora -->
    <div id="log-envios" class="bitacora-envios" style="margin-top: 30px;">
        <h4>Historial de Envíos</h4>
        <ul id="log-lista"></ul>
    </div>
</div>

<!-- Tabla general de datos de la recepción -->
<table class="tabla-detalle-recepcion" style="margin-bottom: 20px;" id="fila-datos-recepcion">
    <thead>
        <tr>
            <th>ID</th>
            <th>Fecha</th>
            <th>Subproceso</th>
            <th>Código Proveedor</th>
            <th>Proveedor</th>
            <th>Link Formulario Padre</th>
    </thead>
    <tbody>
        <!-- Se llenará desde JS -->
    </tbody>
</table>

    
    <!-- Tabla para mostrar los productos de la recepción -->
    <div class="table-container">
        <h3>Productos</h3>
        <table id="tabla-recepcion">
            <thead>
                <tr>
                    <th>Código Producto</th>
                    <th>Código Tango</th>
                    <th>Ins-Mat-Prod</th>
                    <th>Codigo Proveedor</th>
                    <th>Proveedor</th>
                    <th>N° Lote</th>
                    <th>Fecha Vto</th>
                    <th>Temperatura</th>
                    <th>Cantidad</th>
                    <th>N° Partida</th>
                </tr>
            </thead>
            <tbody>
                <!-- Se llenará dinámicamente con JS -->
            </tbody>
        </table>
    </div>

      <!-- Botón de Volver -->
      <button class="btn-volver" onclick="window.location.href='/home'">
        <i class="fas fa-arrow-left"></i> Volver
    </button>

{% endblock %}
